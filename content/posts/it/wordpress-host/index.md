---
date: 2017-04-09T10:58:08-04:00
description: "–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–¥–∏–Ω —Å–∞–π—Ç –Ω–∞ Wordpress. –ö–∞–∑–∞–ª–æ—Å—å –±—ã –Ω–µ —Å–ª–æ–∂–Ω–æ. –í–∑—è—Ç—å —Å–∞–º—É—é —Å–≤–µ–∂—É—é —Å–∏—Å—Ç–µ–º—É, –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –Ω–µ–µ php, nginx, mysql, –∑–∞–∫–∏–Ω—É—Ç—å —Ñ–∞–π–ª—ã Wordpress –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ –∏ –≤—Å–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç! –ò –¥–∞ –∏ –Ω–µ—Ç. –û—Å–æ–±–µ–Ω–Ω–æ, –∫–æ–≥–¥–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ —Å–∞–π—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ."
featured_image: "/images/Pope-Edouard-de-Beaumont-1844.jpg"
images: ["/images/Pope-Edouard-de-Beaumont-1844.jpg"]
tags: ["linux", "wordpress", "colocation"]
categories: "it"
title: "–•–æ—Å—Ç –¥–ª—è Wordpress"
---

## –ü—Ä–æ–µ–∫—Ç. –ú–Ω–æ–≥–æ –∏—Ö

–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–¥–∏–Ω —Å–∞–π—Ç –Ω–∞ Wordpress. –ö–∞–∑–∞–ª–æ—Å—å –±—ã –Ω–µ —Å–ª–æ–∂–Ω–æ. –í–∑—è—Ç—å —Å–∞–º—É—é —Å–≤–µ–∂—É—é —Å–∏—Å—Ç–µ–º—É, –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –Ω–µ–µ php, nginx, mysql, –∑–∞–∫–∏–Ω—É—Ç—å —Ñ–∞–π–ª—ã Wordpress –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ –∏ –≤—Å–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç! –ò –¥–∞ –∏ –Ω–µ—Ç. –û—Å–æ–±–µ–Ω–Ω–æ, –∫–æ–≥–¥–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ —Å–∞–π—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ.

## –ü–ª–∞–Ω

–ü–ª–∞–Ω –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–ª–æ–∂–µ–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ;
- —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è _~/wordpress_, —Ç–∞–º –∂–µ - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å Wordpress _~/uploads_;
- —É –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ _~/wordpress_ –∏ _~/uploads_ —á–µ—Ä–µ–∑ sFTP;
- —É –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –ø–æ SSH;
- –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä–æ–º—É —Ä–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø –ø–æ SSH –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ sudo;
- —Å—Ç–µ–∫: NGINX, MariaDB, PHP-FPM, Sendmail;
- –∫–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å–≤–æ–∏–º –ø—É–ª–æ–º –≤–æ—Ä–∫–µ—Ä–æ–≤ PHP-FPM –∏ –∫–≤–æ—Ç–∞–º–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã;

<!-- TODO: –ø–µ—Ä–º–∏—à–µ–Ω—Å—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
Subsystem sftp internal-sftp -m 0755 -u 022 -->

TODO: —Å–∫—Ä–∏–ø—Ç –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–π–¥–µ—Ç—å—Å—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—á–∫–µ –∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –≤ –±—Ä–æ—É–∑–µ—Ä–µ —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –Ω–∞ –ø–µ—Ä–µ–¥ –∑–∞–¥–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –ª–æ–≥–∏–Ω—ã

## –£—Å–ª–æ–≤–Ω–æ—Å—Ç–∏

–£—Å–ª–æ–≤–Ω–æ—Å—Ç–∏. –ü—Ä–æ—Å—Ç–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∂–µ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –ø–∞—Ä–æ–ª–∏ –∫–∞–∫ –∑–∞–±–ª–∞–≥–æ—Ä–∞—Å—Å—É–¥–∏—Ç—å—Å—è. –ì–ª–∞–≤–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∫–∞–∫, —á—Ç–æ –∏ –≥–¥–µ –Ω–∞–∑–≤–∞–ª–∏.

- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç (`wp-test`);
- –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –∏–º–µ–Ω–µ–º –ø—Ä–æ–µ–∫—Ç–∞ (`wp-test`);
- –ø–∞—Ä–æ–ª—å –≤–µ–∑–¥–µ `password`
- –¥–æ–º–µ–Ω –¥–ª—è –∏–Ω—Å—Ç–∞–Ω—Å–∞ `wp.lxc`;
- –¥–æ–º–µ–Ω —Å–∞–π—Ç–∞ –±—É–¥–µ—Ç `test1.wp.local`;
- –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è Wordpress `admin`;

## –ú–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è

[–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ root]( {{< relref "/posts/it/creating-non-root-user" >}} )


## –°–∏—Å—Ç–µ–º–∞

–ó–∞ –æ—Å–Ω–æ–≤—É –≤–æ–∑—å–º–µ–º —Å–∞–º—ã–π —Å–≤–µ–∂–∏–π [–Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç] TLS —Ä–µ–ª–∏–∑ Ubuntu - **Ubuntu 22.04 LTS**. –î–æ–±–∞–≤–∏–º –∫ –Ω–µ–π —É–∂–µ –ø—Ä–∏–≤—ã—á–Ω—ã–π **LEMP**. –î–ª—è –Ω–∞—á–∞–ª–∞.
–û–±–Ω–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –∏–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –∏ –ø–æ—Å—Ç–∞–≤–∏–º –ø–∞–∫–µ—Ç—ã:

```bash
apt-get update
apt-get upgrade
apt-get install mysql-server mysql-client nginx php-cli php-fpm php-gd php-mysql php-xml php-zip php-imagick php-curl php-mbstring sendmail
```

–î–ª—è **Ubuntu 22.04 LTS** **PHP 8** —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø–ª—è—Å–æ–∫ —Å –±—É–±–Ω–æ–º. –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ. –í–µ—Ä—Å–∏—è **Nginx** –∏ **MariaDB** –Ω–µ —Ç–∞–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã.

> üñâ **NOTE**  
> –ï—Å–ª–∏ –≤—Å–µ –∂–µ –Ω—É–∂–Ω–∞ –¥—Ä—É–≥–∞—è php 
TODO: –æ–ø–∏—Å–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ ondrej —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

## Sendmail

–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω. –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫ Wordpress, –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `wp_mail()` –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä (TODO: link), –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è **PHPMailer** –≤–º–µ—Å—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –≤ PHP —Ñ—É–Ω–∫—Ü–∏–∏ `mail()`. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ—á–µ–º—É-—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∂–∞–ª—É—è—Å—å, —á—Ç–æ **sendmail** –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –ø–∏—Å—å–º–∞ –Ω–µ —Ö–æ–¥—è—Ç. –ù—É –¥–∞ –ª–∞–¥–Ω–æ.

**Sendmail** —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ. –ù–∞–º –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π:

```bash
sendmailconfig
```

–û—Ç–≤–µ—á–∞–µ–º `Y` –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã. –î–æ–ª–∂–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å. –ü–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –ø–∏—Å—å–º–∞ –ø–æ–π–¥—É—Ç. –ü–æ–ø—ã—Ç–∞—é—Ç—Å—è.  
–ö—Å—Ç–∞—Ç–∏ –æ –ø–æ–ø—ã—Ç–∫–µ. –î–∞–≤–∞–π—Ç–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏–º –ø–∏—Å—å–º–æ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Ç–æ, —á—Ç–æ –º—ã —Ç—É—Ç –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏. –î–ª—è —ç—Ç–æ–≥–æ —è –Ω–∞–±—Ä–æ—Å–∞–ª –ø—Ä–æ—Å—Ç–µ–Ω—å–∫–∏–π —Å–∫—Ä–∏–ø—Ç–∏–∫ –Ω–∞ PHP, —á—Ç–æ–±—ã –≤–∞–º –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å:

```bash
<?php 
ini_set( 'display_errors', 1 );
error_reporting( E_ALL );

$from = "emailtest@YOURDOMAIN";
$to = "YOUREMAILADDRESS";

$subject = "PHP Mail Test script";
$message = "This is a test to check the PHP Mail functionality";
$headers = "From:" . $from;

mail($to,$subject,$message, $headers);
echo "Test email sent";
?>
```

–í –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `$from` –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ, –≤ `$to` —è –≤—Å—Ç–∞–≤–∏–ª –ø–æ—á—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –Ω–∞ —Å–µ—Ä–≤–∏—Å–µ Mailinator (TODO: —Å—Å—ã–ª–∫–∞). –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ, –ø—Ä–æ—Å—Ç–æ –≤—ã–±—Ä–∞–ª —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–≤—ã–º –≤—Å–ø–æ–º–Ω–∏–ª—Å—è. –î–ª—è —Ç–∞–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ —Å–µ—Ä–≤–∏—Å—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞ –ø–æ–¥—Ö–æ–¥—è—Ç –æ—Ç–ª–∏—á–Ω–æ - –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ —Å–ø–∞–º-–±–ª–æ–∫–∞. –ï—Å–ª–∏ –ø–∏—Å—å–º–æ –¥–æ—à–ª–æ - —Ç–æ –æ–Ω–æ –¥–æ—à–ª–æ –∏ –µ–≥–æ –æ—Ç–æ–±—Ä–∞–∑—è—Ç. –ï—Å–ª–∏ –Ω–µ –¥–æ—à–ª–æ - –Ω—É–∂–Ω–æ –¥—É—å–∞–∂–∏—Ç—å. –ö–∞–∫ –≤—Å–µ–≥–¥–∞. –í _/var/spool/mail/_ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Ç –ª–∏ —Ç–∞–º —Å–æ–æ–±—â–µ–Ω–∏–π –æ b–æunce –µ—Å–ª–∏ —á—Ç–æ. –¢–∞–º –∂–µ, –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ—á–∏—Ç–∞—Ç—å –∏ –ø—Ä–æ –ø—Ä–∏—á–∏–Ω—É –ø—Ä–∏—á–∏–Ω—É b–æunce.

> üñâ **NOTE**  
> –°–µ–π—á–∞—Å —è –Ω–µ –∑–∞–º–æ—Ä–∞—á–∏–≤–∞—é—Å—å —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –æ—Ç—Å—ã–ª–∫–∏. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –¥–ª—è —ç—Ç–æ–≥–æ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ç–∏–ø–∞ **Sendgrid** –∏–ª–∏ —Ç–æ—Ç –∂–µ **PHPMailer**, –∞ –¥–ª—è –Ω–∏—Ö –±—É–¥–µ—Ç —Å–≤–æ—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.

<!-- –µ—Å–ª–∏ –∏–º–µ–π–ª –Ω–µ –ø–æ—à–µ–ª –ø–æ—à–µ–ª –¥–æ–ª–≥–æ –∏–ª–∏ —Å –æ—à–∏–±–∫–∞–º–∏ –∏—Å–∫–∞—Ç—å –≤ syslog "unqualified hostname unknown; sleeping for retry unqualified hostname" –∏ –µ—Å–ª–∏ –µ—Å—Ç—å 
—Ö–æ—Å—Ç–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –¥–æ–º–µ–Ω–æ–º –∏–ª–∏ –≤ /etc/hosts –∏ –¥–æ–±–∞–≤–ª—è–µ–º 127.0.0.1 –¥–æ–º–µ–Ω.—Å–º–æ—Ç—Ä—è—â–∏–π.–Ω–∞.—Å–∞–π—Ç
-->

<<< –û–°–¢–ê–ù–û–í–ò–õ–°–Ø –¢–£–¢ >>>

## –ì—Ä—É–ø–ø–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

–î–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∫–∞–∂–¥—ã–π —Å–∞–π—Ç –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—â–µ–Ω –ø–æ–¥ —Å–≤–æ–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∫–∞–∂–¥–æ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–µ–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ñ–∞–π–ª–∞–º —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –¢–∞–∫ –∂–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø –ø–æ `sFTP`.–î–æ—Å—Ç—É–ø–∞ –ø–æ `ssh` –Ω–µ –±—É–¥–µ—Ç –Ω–∏ —É –∫–æ–≥–æ (–∫—Ä–æ–º–µ –º–µ–Ω—è, –º—É-a-—Ö–∞-—Ö–∞).  
–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –≥—Ä—É–ø–ø–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –º—ã –±—É–¥–µ–º –ø–æ–º—É—â–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø –ø–æ `sFTP`.

```bash
groupadd sftp-users
```

–ì—Ä—É–ø–ø—É –º–æ–∂–Ω–æ –Ω–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫ —É–≥–æ–¥–Ω–æ, –≥–ª–∞–≤–Ω–æ–µ, –∑–∞–ø–æ–º–Ω–∏—Ç—å –¥–ª—è —á–µ–≥–æ –æ–Ω–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å. –ò –µ—â–µ –æ–¥–Ω–æ- —ç—Ç–∞ –≥—Ä—É–ø–ø–∞ –¥–æ–ª–¥–Ω–∞ –±—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –≥—Ä—É–ø–ø–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (primary group).

–î–∞–ª–µ–µ - —Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –û—Å–Ω–æ–≤–Ω–æ–π –≥—Ä—É–ø–ø–æ–π –±—É–¥–µ—Ç –≥—Ä—É–ø–ø–∞ `sftp-users` - –ø–æ –¥—Ä—É–≥–æ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–∞–∫ –æ–±–æ–ª–æ—á–∫—É –ø–æ—Å—Ç–∞–≤–ª—é –∑–∞–≥–ª—É—à–∫—É `nologin`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ù—É –∏ –ø–∞—Ä–æ–ª—å, –¥–∞.

```bash
useradd -g sftp-users -m -s /sbin/nologin wp-test
usermod -a -G www-data wp-test
passwd wp-test
```

>**NOTE**  
>—É—Å–ª–æ–≤–∏–º—Å—è, —á—Ç–æ –ø–∞—Ä–æ–ª—å –±—É–¥–µ—Ç _password_ –ø—Ä–æ—Å—Ç–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ —Ç–∏–ø–∞ `pwgen -1 -s 64`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–µ–µ –≤–∑–ª–æ–º–æ-—Å—Ç–æ–π–∫–∏–π –ø–∞—Ä–æ–ª—å. –ú–æ–∂–Ω–æ –∏ —Ç–∞–∫ `openssl rand -hex 32`

TODO: –µ—Å–ª–∏ –ø—É–ª–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –ø–æ–¥ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ç–æ –∑–∞–ø–∏—Ö–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É –≤–≤–≤-–¥–∞—Ç–∞ –±—É–¥–µ—Ç –Ω–µ –Ω—É–∂–Ω–æ? –∏–ª–∏ –Ω—É–∂–Ω–æ –∏–∑-–∑–∞ —ç–Ω–∂–¥–∂–∏–Ω–∞?

–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–±–∏—Ä–∞–µ–º –ø–æ —Ç–æ–º—É –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø—É - –≥–ª–∞–≤–Ω–æ–µ –∑–∞–ø–æ–º–Ω–∏—Ç—å —á—Ç–æ —Ç–∞–º. –ù—É –∏–ª–∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≥–¥–µ-—Ç–æ. –ß—Ç–æ, –Ω–∞–≤–µ—Ä–Ω–æ, –Ω–∞–¥—ë–∂–Ω–µ–µ.

>**NOTE**  
>–î–ª—è –¥–µ–º–æ–Ω—Ç—Ä–∞—Ü–∏–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç `wp-test`


## sFTP

–î–ª—è sFTP —Å—Ç–∞–≤–∏—Ç—å –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ. –í—Å–µ —É–∂–µ –∏ —Ç–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. –ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ SSH —Å–µ—Ä–≤–µ—Ä–∞.

>**NOTE**  
>–í —Ç–µ—Ö —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ SSH –≤—Å–µ —Ç–∞–∫–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π `apt-get install openssh-server`

–ù—É–∂–Ω—ã–π –Ω–∞–º –∫–æ–Ω—Ñ–∏–≥ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ñ–∞–π–≤–ª–µ _/etc/ssh/sshd_config_. –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–∫–ª—é–¥—ã –∏ –Ω–µ –±—É–¥–µ–º —Ç—Ä–æ–≥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª.–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–¥–∏–º _/etc/ssh/sshd_config.d/10-sftp.conf_ –∏ –≤–ø–∏—à–µ–º –Ω—É–∂–Ω—ã–µ –æ–ø—Ü–∏–∏ —Ç—É–¥–∞.

```conf
# Subsystem sftp /usr/lib/openssh/sftp-server
Match group sftp-users
ChrootDirectory %h
X11Forwarding no
AllowTcpForwarding no
ForceCommand internal-sftp
```

TODO: —Ä–∞—Å—à–∏–≤—Ñ—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –æ–ø—Ü–∏—é

```bash
chown root:root /home/wp-test/
chmod 755 /home/wp-test/
mkdir /home/wp-test/{uploads,wordpress}
chown wp-test:www-data /home/wp-test/uploads
chown wp-test:www-data /home/wp-test/wordpress
# –æ–±–µ–¥–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤—ã—à–µ –≥–ª–æ–±–æ–º?
# –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å —à–æ—É–ø–ø—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–∞–∫ –≥—Ä—É–ø–ø—É –≤–ª—è–¥–µ—é—â—É—é –∫–æ—Ä–Ω–µ–≤–æ—Ü –ø–∞–ø–∫–æ–π https://serverfault.com/questions/816330/set-ownership-on-uploaded-files
chmod g+s /home/wp-test/{uploads,wordpress}
```

TODO: —á–æ–≤–Ω–∏—Ç—å –Ω–∞ —Ä—É—Ç–∞ –Ω—É–∂–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–Ω–∞—á–µ —á—Ä—É—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–æ—Ä–µ–Ω—å –¥–ª—è —á—å—Ä—É—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ä—É—Ç, –æ—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ –æ—Ç–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–∏—Å—Ç–µ–º—ã
–ó–∞–º–µ—Ç—Ç–µ, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –ø—Ä–µ–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –≠—Ç–æ –Ω–µ–æ–±–∑–æ–¥–∏–º–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã sftp. –í –ø—Ä–æ—á—å–µ–º, —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –¥–æ–º–∞–Ω—à–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–Ω—è–¥–ª–µ–¥–∞—Ç—å –º–æ—à–≥—É—Ç. 

> _man sshd_config_:  
>All components of the pathname must be root-owned directories that are not writable by any other user or group

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–º ssh —Å–µ—Ä–≤–∏—Å –∏ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –æ–Ω –ø–æ–¥–Ω—è–ª—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ:

```bash
sshd -t
systemctl reload sshd
```

TODO: –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –ê+ - –∫–ª—é—á—å –¥–ª—è –ª–æ–≥–∏–Ω–∞ –ø–æ sftp –ø–æ—Ç–æ–º—É –∫–∞–∫ –ø–æ –ø–∞–ø—Ä–æ–ª—é —Ç–∞–∫–∏ –∑–∞—à–∫–≤–∞—Ä) –Ω–µ –∑–∞–±—ã—Ç—å —É–¥–∞–ª–∏—Ç—å –ø–∞—Ä–æ–ª—å —É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏–Ω –ø–æ –ø–∞—Ä–æ–ª—é

–î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å—é–¥–∞.

```bash
mkdir /home/wp-test/.ssh
touch /home/wptest1/.ssh/authorized_keys
chown -R wp-test:sftp-users /home/wptest1/.ssh
vim /home/wptest1/.ssh/authorized_keys
```

TODO: –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ñ—Ç–ø


–µ—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ —Ö–æ—á–µ—Ç –ø–æ –ø–∞—Ä–æ–ª—é? –ü–æ—à–ª–∏—Ç–µ –µ–≥–æ, —ç—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–ø–∞—Å—Ç–Ω–æ —á—Ç–æ–±—ã  —Ç–∞–∫ –¥–µ–ª–∞—Ç—å, –Ω–æ –µ—Å–ª–∏ —É–∂–µ —Å–æ–≤—Å–µ–º —Å–æ–≤—Å–µ–º –Ω–∞–¥–æ:

_/etc/ssh/sshd_config.d/100-allow.password.conf_

```conf
ChallengeResponseAuthentication yes

Match User wp-test
PasswordAuthentication yes
```

–Ω–æ –ª—É—á—à–µ —É–ø–∏—Ä–∞—Ç—å—Å—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ. —Ä–∞–Ω–æ –ª–∏ –ø–æ–∑–¥–Ω–æ –ø–∞—Ä–æ–ª—å –ø–æ–¥–±–µ—Ä—É—Ç.

Received message too long 1416128883
Ensure the remote shell produces no output for non-interactive sessions.
https://unix.stackexchange.com/questions/61580/sftp-gives-an-error-received-message-too-long-and-what-is-the-reason

## –ù–∞—Å—Ç—Ä–æ–∫–∞ –±–∞–∑—ã

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–∂–Ω–æ –ø—Ä–µ—Å—Ç—É–ø–∏—Ç—å –∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –±–∞–∑—ã –¥–ª—è CMS. –ù–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–¥–∞—Ç—å —ç—Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∞–≤–∞ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π. –°–µ–π—á–∞—Å –Ω–∞–º –Ω—É–∂–Ω–æ –æ–∫–∞–∑–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ MySQL –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º root.

```bash
mysql
```

–î–∞–ª–µ–µ, —Å–æ–∑–¥–∞–¥–∏–º –±–∞–∑—É, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–¥–∞–¥–∏–º –µ–º—É –ø—Ä–∞–≤–∞:

```sql
CREATE DATABASE `wp-test`;
CREATE USER 'wp-test'@'localhost' IDENTIFIED BY 'password';
GRANT ALL ON `wp-test`.* TO 'wp-test'@'localhost'; #WITH GRANT OPTION
FLUSH PRIVILEGES;
exit;
```
TODO: —Ä–∞—Å—à–∏–≤—Ñ—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –æ–ø—Ü–∏—é –∏ —á—Ç–æ –∑–Ω–∞—á–∏—Ç –ª–æ–∫–∞–ª—Ö–æ—Å—Ç –∏ –ø—Ä–æ—Ü–µ–µ–Ω—Ç–∏–∫ –µ—Å–ª–∏ –±—ã —å—ã–ª –∏–ª–∏ –∞–¥—Ä–µ—Å –∏ —á—Ç–æ –∑–Ω–∞—á–∞—Ç –∑–≤–µ–∑–¥–æ—á–∫–∏ (–Ω–∞–¥–æ –ª–∏ —Ç—É—Ç —É–∂–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç–∞—Ç—å—é —Ç—è–Ω–µ—Ç)
TODO: !!! https://www.strongdm.com/blog/mysql-create-user-manage-access-privileges-how-to


## Wordpress cli –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ CMS

https://wp-cli.org/#installing

```bash
wget https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
php wp-cli.phar --info
chmod +x wp-cli.phar
mv wp-cli.phar /usr/local/bin/wp
```

TODO: —Ç—É—Ç –Ω—É–∂–Ω–æ –±—É—Ç—å–ø–æ–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–º –ª–∏—à –±—ã –Ω–µ —Ä—É—Ç –∏–Ω–∞—á–µ –∑–∞–¥–æ–ª–±–∞–µ—Ç –∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –≥–¥–µ –≤—ã–ª–µ–∑–µ—Ç –µ—â–µ –≤ –∏–¥–µ–∞–ª–µ —Ç–µ–º –∂–µ –∫–µ–º –∏ –±—É–¥—Ç–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—Å—å—è –∞ –∑–∞—Ç–µ–º –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω—É—Ç—å –µ–º—É –∑–∞–ø—Ä–µ—Ç –Ω–∞ –ª–æ–≥–∏–Ω. –ø—Ä–æ–±—É—é –ø–æ–¥ —Ä—É—Ç–æ–º —Å --allow-root –∞ —Ç–∞–º –ø–æ–≥–ª—è–¥–∏–º

—á—Ç–æ—é—ã –æ—Ç–¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∫–∞–∫ –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ –ø—Ä–∏ –∂—Ç–æ–º –Ω–µ –ª–æ–≥–∏–Ω–∏—Ç—å—è –≤ –Ω–µ–≥–æ –≤–æ—Å–ø–æ–ª—å—â—É–µ–º—Å—è sudo —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–µ—Å–ª–∏ –º—ã –ø—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–µ–º —Å—É –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–ø-—Ç–µ—Å—Ç —Ç–æ —Å–∏—Ç–µ–º–∞ –Ω–∞–º –Ω–µ –¥–∞—Å—Ç —ç—Ç–æ–≥–æ —Å–¥–µ–æ–∞—Ç—å —Å–æ—Å–ª–∞–≤—à–∏—Å—å –Ω–∞ —Ç–æ —á—Ç–æ –ø–ª—å–∑—â–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω `This account is currently not available.` —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ —ç—Ç–æ –∏—Å–ø–æ–ª—å—â–∑—É–µ—Å

```bash
sudo -u wp-test -s /bin/bash
# –∏–ª–∏
sudo su wp-test -s /bin/bash
```

–µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–æ–º–∞–Ω–¥—É –±–µ–∑ —Å—É–¥–æ –∏ –≤–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø—è—Ç—å –∂–µ –ø–æ–ª—É—á–∏–º –æ–≤\\–æ—Ç–≤–µ—Ç –æ —Ç–æ–º —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

```bash
# cd /home/wp-test/wordpress
cd ~/wordpress
wp core download
# make couple of spaces pefore conmmand so bash wont savw this command in history
wp core config --dbhost=localhost --dbname=wp-test --dbuser=wp-test --dbpass=password

# wp coonfig FS_METHOD ssh2
wp config set FS_METHOD direct
# wp config set WP_MEMORY_LIMIT 128M #500M
# wp config WP_DEBUG_DISPLAY false
# wp config set WP_DEBUG true
# wp config set WP_DEBUG_LOG true
# wp config set FORCE_SSL_ADMIN true



# chmod 644 wp-config.php
# make couple of spaces pefore conmmand so bash wont savw this command in history
wp core install --url=wp-test.wp.local --title="Your Blog Title" --admin_name=admin --admin_password="password" --admin_email=you@example.com

# chmod 775 wp-content/uploads/
# chmod 775 wp-content/plugins/
# chmod 775 wp-content/themes/
# ??? chown -R wp-test:www-data ./
# —á–µ–∫–Ω—É—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ –≤—Å—è–∫–∏–π, –ø–æ –∏–¥–µ–µ —á–æ–≤–Ω–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç
```

–ø—Ä–æ–≤–µ—Ä–∏–º –≤—Å–µ –ª–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å.

```bash
wp server --htost=0.0.0.0 --port=80
```

—à–∞–≥ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π. —ç—Ç–æ –ø–æ–¥–Ω–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ. –ø–µ—Ä–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–Ω –æ—á–µ–Ω—å –¥–æ–ª–≥–∏–º

–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å —É—Ä–ª

```bash
wp option update home 'http://wp-test.wp.local'
wp option update siteurl 'http://wp-test.wp.local'
```

```bash
wp user reset-password admin
```

–Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å —É–π–¥–µ—Ç –Ω–∞ –ø–æ—á—Ç—É –∞–¥–º–∏–Ω–∞

http://wp-test.local/wp-admin/site-health.php?tab=debug
infp filesystem permisiions
–∞–¥–º–∏–Ω–∫–∞ –æ—á—ã—á–Ω–æ –Ω–∞ /wp-login



## –ù–∞—Å—Ç—Ä–æ–∫–∞ web —Å–µ—Ä–≤–µ—Ä–∞

FIXME: –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–≤–æ–π –∫–æ–Ω—Ñ–∏–≥, —Å–º–µ—à–Ω–æ –Ω–æ –≤–æ—Ä–¥—Ä–µ—Å—Å–æ–≤—Å–∫–∏–π –ø–æ—Ö–æ–∂–µ –Ω–µ —Å–∏–ª—å–Ω–æ —Ö–æ—á–µ—Ç —Ä–∞–±–æ—Ç–∞—å 

–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π nginx
–∫–æ—Ñ–∏–≥ –≤–∑—è—Ç –∏–∑ —Ñ–æ—Ñ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –∫–æ–∫—É–º–µ–Ω—Ç–∞–π–∏–∏ –ø–æ –≤–æ—Ä–¥–ø–µ—Ä–µ—Å—Å—É
https://wordpress.org/support/article/nginx/

_/etc/nginx/sites-available/wp-test.conf_

```nginx
client_max_body_size 10M;

upstream php {
        server unix:/var/run/php/php-fpm.sock;
        # server 127.0.0.1:9000;
}

#server {
#        server_name www.wp-test.local;
#        return 301 $scheme://wp-test.local$request_uri;
#}

server {
        server_name wp-test.local;
        listen 80;
        root /home/wp-test/wordpress;
        index index.php;
 
        location = /favicon.ico {
                log_not_found off;
                access_log off;
        }
 
        location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
        }
 
        location / {
                try_files $uri $uri/ /index.php$is_args$args;
        }
 
        location ~ \.php$ {
                #NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
                include fastcgi.conf;
                fastcgi_intercept_errors on;
                fastcgi_pass php;
        }
 
        location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
                expires max;
                log_not_found off;
        }
}
```

!!! client_max_body_size 100M;

```bash
ln -s /etc/nginx/sites-available/wp-test.conf /etc/nginx/sites-enabled
nginx -t
nginx -s reload
```



## –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è https

TODO: –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ–π –∫–∞–∫ –ø—Ä–∏–∫—Ä—É—Ç–∏—Ç—å —Å—Å–ª –∫ –Ω–≥–∏–Ω–∏–∫—Å –≤ –∞–≤—Ç–æ —Ä–µ–∂–∏–º–µ —Å–µ—Ä—Ç–±–æ—Ç–æ–º –∫ –≥–æ–ª–æ–º—É —ç–Ω–¥–∂–∏–Ω—É

```bash
apt-get install certbot python3-certbot-nginx

cp /etc/nginx/sites-available/wp-test.conf /etc/nginx/sites-available/wp-test.conf.bak

certbot --nginx
# certbot --nginx -d example.com -d www.example.com
```

–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—Ç–æ–≤ –∫–∞–∫ —É –º–µ–Ω—è –≤ –∑–∞–º–µ—Ç–∫–∞—Ö

```bash
certbot renew --nginx
```

```conf
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

0 */12 * * * root certbot -q renew --nginx
```



## htpasswd

TODO: –¥–æ–±–∞–≤–∏—Ç—å –∫ –æ–ø–∏—Å–∞–Ω—Ä–∏—é —É—Å—Ç–∞–Ω–æ–≤–∫–∏ htpasswd –∏–ª–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ –Ω–ø–∏—Å–∞—Ç—å —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å
https://www.digitalocean.com/community/tutorials/how-to-set-up-password-authentication-with-nginx-on-ubuntu-14-04




## –°–∏–Ω–æ–ø—Å–∏—Å

TODO: –∫–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã, –∫–∞–∫–∏–µ —É—á–µ—Ç–∫–∏, –∫–∞–∫ –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è, –≥–¥–µ —á—Ç–æ –∞–Ω—Ö–æ–¥–∏—Ç—å—Å—è

---

## Extra: FTP —Å–µ—Ä–≤–µ—Ä (–Ω–∞—Ö—Ä–µ–Ω —Ñ—Ç–ø, –≤–æ—Ç —á–µ—Å—Ç–Ω–æ)

–ö–æ–≥–¥–∞ —Å—Ñ—Ç–ø –Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç


—á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∂–µ–ª–∞–Ω–Ω—ã–µ 755
local_umask=002
file_open_mode=0755

–∏ —Å–µ—Ä—Ç –¥–ª—è –Ω–µ–≥–æ. –Ω–æ –≤–ø –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ñ—Ç–ø –ø–æ–∂—Ç–æ–º—É —ç—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –±–æ–ª—å—à–µ–Ω—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–∏. –Ω–∞ –ø\–æ–ø–∏—Å—ã–≤–∞—Ç—å?

## Extra: Firewall

sudo ufw allow ssh
sudo ufw enable
sudo ufw status


## Extra: clean history 

history -c && exit

## —Ç—é–Ω–∏–Ω–≥ —ç–Ω–¥–∂–∏–Ω–∞
TODO: –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ–π?

 –≥–∑–∏–ø
 –∫–µ—à–∏

https://stackoverflow.com/questions/66356142/time-out-504-gateway-time-out-nginx-in-wordpress-php-fpm
—Ç–æ–ª—å–∫–æ –¥–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ 60 –∫–∞–∫ –±—ã –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–æ–≤–Ω—è—Ç—å —Å–æ –≤—Å–µ–º–∏ –∏ —Å—Ç–∞–≤–∏—Ç—å 300
–∫–æ–µ –≥–¥–µ –∏ 600 –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å —Å—Ç–∞–≤–∏—Ç—å

–ø—Ä–æ—Å—Ç–æ –¥–∞–º–ø, –∫–∞–∫ –ø–æ–¥–±–∏—Ä–∞–ª–∏—Å—å - —è —Ö–∑) —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏
https://gist.github.com/denji/8359866

_/etc/nginx/conf.d/tuning.conf_
...
client_max_body_size 128M;
proxy_buffer_size   128k;
proxy_buffers   4 256k;
proxy_busy_buffers_size   256k;
client_max_body_size 100M;
sendfile on;
tcp_nopush on;
tcp_nodelay on;

client_body_timeout 10;
send_timeout 2;
keepalive_timeout 30;
keepalive_requests 100000;

server_tokens off;

gzip on;
# gzip_static on;
gzip_min_length 10240;
gzip_comp_level 1;
gzip_vary on;
gzip_disable msie6;
gzip_proxied expired no-cache no-store private auth;
reset_timedout_connection on;
gzip_types
        # text/html is always compressed by HttpGzipModule
        text/css
        text/javascript
        text/xml
        text/plain
        text/x-component
        application/javascript
        application/x-javascript
        application/json
        application/xml
        application/rssxml
        application/atom+xml
        font/truetype
        font/opentype
        application/vnd.ms-fontobject
        image/svg+xml;
...


## —Ä–µ–∑–¥–µ–ª–µ–Ω–∏–µ –ø—É–ª–æ–≤ - –Ω–µ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—Å—è

## —Ç—é–Ω–∏–Ω–≥ –ø—ã—Ö–∞
TODO: –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ–π?

_/etc/php/${php-version}/fpm/php.ini_

```ini
max_execution_time = 600
max_input_time = 600
post_max_size = 100M
upload_max_filesize = 3G
memory_limit = 128M
```

_/etc/php/7.4/fpm/pool.d/www.conf_
```ini
pm.max_children = 50
pm.start_servers = 10
pm.min_spare_servers = 10
pm.max_spare_servers = 20
pm.max_requests = 1000
```

–û–°–ù–û–í–ù–û–¶ –†–´–ß–ê–ì - –ö–û–õ–ò–ß–ï–°–¢–í–û –ó–ê–ü–†–û–°–û–í –ù–ê –ü–†–û–¶–ï–°–°????

–¥–∏–Ω–∞–º–∏–∫ –¥–ª—è —à–∞—Ä–µ–¥–∞ —Å —Ä–∞–∑–¥–µ–ª—å–Ω–º–∏ –ø—É–ª–∞–º–∏
–°–¢–ê–¢–ò–ö –ú–û–î –¥–ª—è –ø—Ä–æ–¥–∞!!!
–∫–∞–∫ —Ç–æ –∂ –º–æ–∂–Ω–æ –≤—ã—Å—á–∏—Ç—ã–≤–∞—Ç—å —á—Ç–æ–±—ã –≤ –ø–∞–º—è—Ç—å –≤–ø–∏—Å—ã–≤–∞–ª–æ—Å—å

—Å–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ - –ø—Ä–æ—Å–∏—Ç –±–æ–ª—å—à–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ - –¥–∞–µ–º, —Å–º–æ—Ç—Ä–∏–º —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–∏–ª–æ –ø–∞–º—è—Ç—å, –±–∞–∑–∞–Ω—Å–∏—Ä—É–µ–º. —Ç–∞–∫ –∂–µ –∫–æ–ª –≤–æ —Ä–µ–∫–≤–µ—Å—Ç–æ–≤ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å —Ç–æ–∂–µ –º–æ–∂–Ω–æ –ø–æ–¥–∫—Ä—É—Ç–∏—Ç—å

—Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø—É–ª—ã
–±–µ–∑–æ–ø–∞—Å—Ç–Ω–æ—Å—Ç—å –∏ —Ä–µ—Å—É—Ä—Å—ã —Ä–∞—Å–ø—Ä–¥–µ–ª–µ–Ω–∏–µ
–∫–∞–∂–¥—ã—Ü –ø—É–ª –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –≤–ª—è–¥–µ–ª—å—Ü–∞ –ø—Ä–æ–µ–∫—Ç–æ–º
—É –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞ —Å–≤–æ–π —Å–æ–∫–µ—Ç?
–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ø—Ö–ø –∏–Ω–∏?
–≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
–∫–æ–Ω—Ñ–∏–≥–∏ –±—Ä–∞—Ç—å –∏–∑ –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∞–∫–∞ —Å –ø–æ–º–µ—Ç–∫–æ–π "–º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–ª–∏—Ç—Å—è"
—Ç–∞–º–∞—É—Ç—ã —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø—Ä–∏—à–ª–æ—Å—å —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∏–∑–∑–∞ –ø–ª–æ—Ö–æ —Ö–æ–¥–∏—â–∏—Ö –ø–∏—Å–∞–º


## –∫–≤–æ—Ç—ã –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

–ù–ê–î–û!!!

## sendmail + multiple domains

https://gist.github.com/adamstac/7462202
https://www.techrepublic.com/article/configure-it-quick-set-up-sendmail-to-host-multiple-domains/

–æ—Ç—Å—ã–ª–∫–∞ –ø–æ—á—Ç—ã —Ç–æ—Ä–º–æ–∑–∏—Ç –≤—Å–µ –∏ –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
—Ç–∞–∫ –∂–µ –≥–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –µ—Å–ª–∏ –±–∞–Ω—Å—ã
https://serverfault.com/questions/58363/my-unqualified-host-name-foo-bar-unknown-problem
/var/spool/mail
 unable to qualify my own domain name (localhost) -- using short name


## –≠–∫—Å—Ç—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–∑–º–µ—Ä–∞ –∑–∞–ª–∏–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

https://www.tecmint.com/increase-file-upload-size-in-php/
https://www.tecmint.com/limit-file-upload-size-in-nginx/
https://www.cloudways.com/blog/increase-media-file-maximum-upload-size-in-wordpress/


## –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ

https://wp-cli.org/
https://wordpress.org/support/